sqoop import \
--connect jdbc:mysql://localhost/CDW_SAPP \
--driver com.mysql.jdbc.Driver \
--username root --password password \
--query "select 
	BRANCH_CODE,
    BRANCH_NAME,
    BRANCH_STREET,
    BRANCH_CITY,
    BRANCH_STATE, CASE WHEN LENGTH(CAST(BRANCH_ZIP AS SIGNED)) = 5 THEN CAST(BRANCH_ZIP AS SIGNED)
  WHEN LENGTH(CAST(BRANCH_ZIP AS SIGNED)) = 4 THEN CONCAT('0',CAST(BRANCH_ZIP AS SIGNED))
  WHEN LENGTH(CAST(BRANCH_ZIP AS SIGNED)) = 3 THEN CONCAT('00',CAST(BRANCH_ZIP AS SIGNED))
   WHEN BRANCH_ZIP IS NULL THEN '999999'
	END AS BRANCH_ZIP,
    CONCAT('(',LEFT(BRANCH_PHONE,3),')',SUBSTRING(BRANCH_PHONE,4,3),'-',SUBSTRING(BRANCH_PHONE,7,4)),
    LAST_UPDATED
from CDW_SAPP_BRANCH WHERE \$CONDITIONS" \
--split-by BRANCH_CODE \
--m 1 \
--target-dir ExtractionModule/CDW_SAPP_D_BRANCH



MYSQL QUERY:
select 
	BRANCH_CODE,
    BRANCH_NAME,
    BRANCH_STREET,
    BRANCH_CITY,
    BRANCH_STATE,
	CASE	WHEN LENGTH(CAST(BRANCH_ZIP AS SIGNED)) = 5
			THEN CAST(BRANCH_ZIP AS SIGNED)
			WHEN LENGTH(CAST(BRANCH_ZIP AS SIGNED)) = 4
			THEN CONCAT('0',CAST(BRANCH_ZIP AS SIGNED))
			WHEN LENGTH(CAST(BRANCH_ZIP AS SIGNED)) = 3
			THEN CONCAT('00',CAST(BRANCH_ZIP AS SIGNED))
            WHEN BRANCH_ZIP IS NULL
            THEN '999999'
	END AS BRANCH_ZIP,
    CONCAT('(',LEFT(BRANCH_PHONE,3),')',SUBSTRING(BRANCH_PHONE,4,3),'-',SUBSTRING(BRANCH_PHONE,7,4)),
    LAST_UPDATED
from CDW_SAPP_BRANCH;
